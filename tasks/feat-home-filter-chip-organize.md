# feat-home-filter-chip-organize

## 目的

- Home（大会一覧）の適用中フィルタチップで、状態/条件/種別の階層を即座に判別できるようにする。
- チップ表示を固定上限（最大3件）にし、超過分を `+N` に集約してレイアウトの横伸びを防ぐ。
- Home上の「すべて解除」の強調を弱め、誤タップリスクを下げる。
- フィルタ機能仕様（絞り込み結果、ソート維持）を変更せず、表示ロジックと見た目のみを調整する。

## 非目的

- フィルタ条件の追加/削除、絞り込みアルゴリズム変更。
- ソート仕様変更（表示位置・ソート結果・保存形式）。
- Home 以外の画面構造変更。
- Web Locks / Service Worker / DB / import-export / CI への変更。

## 変更点

- 適用中フィルタチップの表示用モデルを導入し、各チップに `category`（status/condition/type）と `priority` を付与する。
- チップ表示順をカテゴリ順（status → condition → type）かつ同カテゴリ内優先度順に固定する。
- 代表表示を `MAX_VISIBLE_CHIPS = 3` に固定し、超過分を `+N` チップへ集約する。
- 代表表示の選択ルールを実装する:
  - status: 最大1件（該当時は優先表示）
  - condition: 最大2件（優先度順）
  - type: 原則省略（空き枠がある場合のみ最大1件）
- `+N` チップ押下でフィルタボトムシートを開く挙動を維持する（Home上で展開しない）。
- Homeのチップ列から「すべて解除」を撤去し、フィルタボトムシート内へ弱い表現（text button）として移設する。
- チップ間の gap を軽微に増やし、視覚的な詰まりを緩和する。

## 影響範囲

- ユーザー影響:
  - Homeの適用中チップがカテゴリごとに見分けやすくなる。
  - 表示チップ数が常に固定化され、過密時は `+N` に集約される。
  - 「すべて解除」の主導線がHome列からボトムシートへ移る。
- データ影響:
  - `home.state` / `home.searchText` / `home.filter.category` / `home.filter.attrs` / `home.sort` の保存形式変更なし。
- 互換性:
  - 既存フィルタ条件・絞り込み結果・ソート維持挙動は継続。

## 実装方針（対象ファイル単位）

- `packages/web-app/src/App.tsx`
  - Home適用チップの表示用モデル生成ロジックを追加する。
  - カテゴリ順・優先度順ソート、固定3件抽出、`+N` 生成を実装する。
  - チップ描画をモデル駆動に置き換え、カテゴリ別 variant（filled/tonal/outlined）を反映する。
  - Homeチップ列の「すべて解除」を削除し、フィルタボトムシートの actions へ text button を追加する。
- `packages/web-app/src/styles.css`
  - チップ列の gap を微増する。
  - condition/type/+N 用の軽量クラスを追加し、カテゴリ別の視覚差をスタイルで補強する（既存テーマ色内）。
- `tasks/feat-home-filter-chip-organize.md`
  - 本タスクの計画とスコープ固定を記録する（本ファイル）。

## テスト観点

- status/condition/type のカテゴリ順でチップが表示される。
- condition が優先度順で最大2件表示される。
- type は空き枠がある場合のみ表示される。
- 代表表示は常に最大3件で、超過分が `+N` として表示される。
- `+N` 押下でフィルタボトムシートが開く。
- Home上に「すべて解除」が表示されず、ボトムシート内で利用できる。
- 「すべて解除」でフィルタは解除されるがソートは保持される。
- 絞り込み結果そのものが回帰しない。

## ロールバック方針

- 本変更コミットをリバートし、Homeチップ列の旧描画ロジックへ戻す。
- ボトムシートへ移設した「すべて解除」導線を戻す。
- スタイル追加クラスを同時に巻き戻し、既存見た目に復帰する。

## Commit Plan（コミット分割計画）

1. Plan文書追加（tasks ファイル作成）
2. Homeチップ表示ロジック更新（カテゴリ化・優先順位・固定3件・`+N`）
3. UI導線/スタイル更新（clear all 移設、カテゴリ見た目差分、余白微調整）
4. 検証（lint/test）と最終差分確認
